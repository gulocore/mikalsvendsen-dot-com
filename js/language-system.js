var K=Object.create;var O=Object.defineProperty;var X=Object.getOwnPropertyDescriptor;var Z=Object.getOwnPropertyNames;var tt=Object.getPrototypeOf,et=Object.prototype.hasOwnProperty;var at=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var nt=(t,e,a,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Z(e))!et.call(t,r)&&r!==a&&O(t,r,{get:()=>e[r],enumerable:!(n=X(e,r))||n.enumerable});return t};var k=(t,e,a)=>(a=t!=null?K(tt(t)):{},nt(e||!t||!t.__esModule?O(a,"default",{value:t,enumerable:!0}):a,t));var $=at((wt,C)=>{C.exports={website_title:"Mikal Svendsen",year:new Date().getFullYear(),mobile_size_width:768,lang_pref_key:"languagePreference",lang_key:"lang",ignore_pref_lang_param:"ignorePrefLang",available_languages:["en","sv","no"]}});async function m(t,e="page",a=null){if(e==="page"&&window.languageStrings[t])return window.languageStrings[t];let n=`lang_${e}_${a||window.pageId}_${t}`,r=E(n);if(r)return r;let o;if(e==="page"?o=window.languageManifest[t]:e==="post"&&a?(o=(window.languageManifest?.postPaths||{})[a]?.[t],o||(o=`/js/generated/lang/${`_blog_posts_${a.replace(/\//g,"_").replace(/-/g,"_")}`}.${t}.json`)):e==="qa"&&(o=window.languageManifest.qa_items?.[t]),!o)return console.warn(`No language file found for ${t} (type: ${e}, id: ${a})`),null;try{let c=await fetch(o);if(!c.ok)throw new Error(`Failed to load language data: ${c.status}`);let i=await c.json();return q(n,i),i}catch(c){return console.error("Error loading language data:",c),null}}function q(t,e){try{sessionStorage.setItem(t,JSON.stringify(e))}catch{}}function E(t){try{let e=sessionStorage.getItem(t);return e?JSON.parse(e):null}catch{return null}}var w=k($()),G=w.ignore_pref_lang_param,F=w.lang_key,H=w.lang_pref_key,ot=w.available_languages;function y(t,e=null){return new URLSearchParams(window.location.search).get(t)||e}function N(){let t=new URLSearchParams(window.location.search),e=t.get(F),a=t.has(G),n=L();return a?e&&h(e)?e:"en":n&&h(n)?n:e&&h(e)?e:"en"}function h(t){return(window.availableLanguages||ot).includes(t)}function L(){return localStorage.getItem(H)}function x(t){new URLSearchParams(window.location.search).has(G)||h(t)&&localStorage.setItem(H,t)}function P(t,e=!0){if(!h(t))return;let a=new URL(window.location.href);a.searchParams.set(F,t),window.history.replaceState({},"",a.toString()),e&&typeof window.updatePageLanguage=="function"&&window.updatePageLanguage(t)}var _=k($()),Y=_.ignore_pref_lang_param,T=_.lang_key;async function I(t=null,e){let a=t||y(T,"en");z(a);try{if(!window.languageStrings[a]){let c=await m(a,"page");if(c)window.languageStrings[a]=c;else if(console.warn(`Failed to load ${a} language data, falling back to English`),!window.languageStrings.en){let i=await m("en","page");i&&(window.languageStrings.en=i)}}let n=window.languageStrings[a]||window.languageStrings.en;n&&Object.keys(n).forEach(function(c){document.querySelectorAll(`[data-string="${c}"]`).forEach(function(s){s.hasAttribute("placeholder")?s.setAttribute("placeholder",n[c]):s.tagName==="LI"&&n[c].includes("<")?s.innerHTML=n[c]:s.textContent=n[c]})}),W(a,e.i18nGlobal),document.querySelectorAll("[data-feed-link]").forEach(c=>{let i=`/feed/${a}.json`;c.setAttribute("href",i)}),window.location.pathname.includes("/qa/")&&await j(a),await B(a),document.querySelector('[data-string="title"]')&&n?.title&&(document.title=e.globalConfig.website_title+" | "+n.title),window.currentLanguage=a,rt(a),document.dispatchEvent(new CustomEvent("languageChanged",{detail:{language:a}}))}catch(n){console.error("Error updating language:",n)}finally{J()}}function z(t){let e=document.querySelector(".language-switcher");if(!e)return;let a=e.querySelector(`[data-language="${t}"]`);a&&a.classList.add("loading"),e.classList.add("loading")}function J(){let t=document.querySelector(".language-switcher");if(!t)return;t.querySelectorAll("[data-language]").forEach(a=>{a.classList.remove("loading")}),t.classList.remove("loading")}function v(t){document.querySelectorAll(".language-switcher a").forEach(a=>{a.getAttribute("data-language")===t?a.classList.add("active"):a.classList.remove("active")})}function W(t,e){if(!e||!e[t])return;let a=e[t].nav;a&&Object.keys(a).forEach(function(n){document.querySelectorAll(`[data-nav="${n}"]`).forEach(function(o){o.textContent=a[n]})})}async function j(t){if(!window.qaItemsData)return;let e=!0;if(Object.keys(window.qaItemsData).forEach(a=>{(!window.qaItemsData[a].question[t]||!window.qaItemsData[a].answer[t])&&(e=!1)}),!e){let a=await m(t,"qa");a&&Object.keys(a).forEach(n=>{window.qaItemsData[n]?(a[n].question&&(window.qaItemsData[n].question||(window.qaItemsData[n].question={}),window.qaItemsData[n].question[t]=a[n].question[t]),a[n].answer&&(window.qaItemsData[n].answer||(window.qaItemsData[n].answer={}),window.qaItemsData[n].answer[t]=a[n].answer[t])):window.qaItemsData[n]=a[n]})}Object.keys(window.qaItemsData).forEach(function(a){let n=document.querySelector(`[data-qa-id="${a}"]`);if(!n)return;let r=window.qaItemsData[a];if(r.question&&r.question[t]){let o=n.querySelector(".qa-question h2");o&&(o.textContent=r.question[t])}if(r.answer&&r.answer[t]){let o=n.querySelector(".qa-answer-content");o&&(o.textContent=r.answer[t])}})}async function B(t){let e=document.querySelectorAll("[data-post-id], [data-post-title], [data-post-excerpt]");if(e.length===0)return;let a=new Set;e.forEach(i=>{let s=i.getAttribute("data-post-id")||i.getAttribute("data-post-title")||i.getAttribute("data-post-excerpt");s&&a.add(s)});let n=window.languageManifest?.postPaths||{};for(let i of a){if(!i)continue;let s=n[i]?.[t];if(!s){let g=i.startsWith("/")?i.substring(1):i;if(s=n[g]?.[t],!s){let p=i.split("/").pop();s=n[p]?.[t],s||(s=`/js/generated/lang/${`_blog_posts_${i.split("/").pop().replace(/-/g,"_")}`}.${t}.json`,console.log(`Using fallback URL for ${i}: ${s}`))}}let l=`lang_post_${i}_${t}`,u=E(l);if(!u)try{console.log(`Fetching post data from: ${s}`);let g=await fetch(s);if(!g.ok)throw new Error(`Failed to load post language data: ${g.status}`);u=await g.json(),q(l,u)}catch(g){console.error(`Error loading post data for ${i}:`,g);continue}u&&V(i,u,t)}let o=new URLSearchParams(window.location.search).has(Y);document.querySelectorAll(".blog-card-link").forEach(i=>{let l=i.getAttribute("href").split("?")[0];o?i.setAttribute("href",`${l}?${T}=${t}&${Y}`):i.setAttribute("href",`${l}?${T}=${t}`)})}function rt(t){if(console.log("Updating SEO tags for language:",t),!window.pageData||!window.pageData.siteMetadata){console.warn("SEO update failed: Missing metadata");return}let e=window.pageData.siteMetadata;console.log("Using metadata:",e);let a=document.querySelector('[data-string="title"]'),n=a?a.textContent.trim():"",r=e.title[t]||e.title.en,o=document.querySelector('[data-seo="og-title"]');o&&(o.setAttribute("content",n?`${n} | ${r}`:r),console.log("Updated og:title to:",o.getAttribute("content")));let c=document.querySelector('[data-seo="description"]');if(c){let g;if(window.languageStrings&&window.languageStrings[t]&&window.languageStrings[t].description&&(g=window.languageStrings[t].description),!g){let d=document.querySelector("meta[data-post-excerpt]");d&&d.getAttribute("content")&&(g=d.getAttribute("content"))}if(!g){let d=document.querySelector('[data-string="intro"]');d&&(g=d.textContent.trim())}if(!g){let d=document.querySelector(".blog-post-content .text-section");d&&(g=d.textContent.trim(),console.log("Using first paragraph as excerpt:",g))}g||(g=e.description[t]||e.description.en),c.setAttribute("content",g);let p=document.querySelector('[data-seo="og-description"]');p&&p.setAttribute("content",g);let b=document.querySelector('[data-seo="twitter-description"]');b&&b.setAttribute("content",g),console.log("Updated description to:",g)}let i=document.querySelector('[data-seo="canonical"]');if(i){let g=window.location.pathname,p=`${e.mainDomain}${g}?lang=${t}`;i.setAttribute("href",p),console.log("Updated canonical URL to:",p)}let s=document.querySelector('[data-seo="locale"]');s&&s.setAttribute("content",t);let l=document.querySelector('[data-seo="content-language"]');l&&l.setAttribute("content",t),document.documentElement.setAttribute("lang",t);let u=document.querySelector('[data-seo="site-name"]');if(u){let g=e.siteName||"Unknown";u.setAttribute("content",g),document.querySelectorAll('meta[property="article:publisher"], meta[name="publisher"]').forEach(b=>{b.setAttribute("content",g)})}gt(t),ct(t),it(t),st(t),console.log("SEO tags updated successfully!")}function it(t){let e=window.pageData.siteMetadata;if(!e)return;let a=window.languageStrings[t]||{},n=new URL(window.location.href);n.searchParams.set("lang",t);let r=n.toString(),o=document.querySelector('[data-string="title"]')?.textContent.trim()||"",c;a.description?c=a.description:document.querySelector('[data-string="intro"]')?c=document.querySelector('[data-string="intro"]').textContent.trim():c=e.description[t]||e.description.en;let i=(s,l)=>{let u=document.getElementById(`structured-data-${s}`);if(u)try{let g=JSON.parse(u.textContent);l(g),u.textContent=JSON.stringify(g)}catch(g){console.error(`Error updating structured data for ${s}:`,g)}};i("blog",s=>{if(s.headline=o,s.description=c,s.inLanguage=t,s.url=r,s.mainEntityOfPage["@id"]=r,s.publisher&&typeof s.publisher.logo!="object"&&(s.publisher.logo={"@type":"ImageObject",url:`${e.mainDomain}/img/logo.png`}),s.image&&typeof s.image=="object"){let l=document.querySelector(".blog-post-thumbnail img");if(l&&l.src){let u=new URL(l.src,window.location.origin).href;s.image.url=u}}}),i("faq",s=>{s.inLanguage=t}),i("website",s=>{s.inLanguage=t,s.description=e.description[t]||e.description.en}),i("webpage",s=>{s.inLanguage=t,s.name=o,s.description=c,s.url=r})}function st(t){let e=window.location.href.split("?")[0];(window.availableLanguages||[]).forEach(r=>{let o=document.querySelector(`[data-seo="hreflang-${r}"]`);o&&o.setAttribute("href",`${e}?lang=${r}`)});let n=document.querySelector('[data-seo="hreflang-default"]');n&&n.setAttribute("href",`${e}?lang=en`)}function ct(t){let e=window.pageData.siteMetadata;if(!e)return;let a=window.languageStrings[t]||{},n=document.querySelector('[data-string="title"]')?.textContent.trim()||"",r=e.title[t]||e.title.en,o=n?`${n} | ${r}`:r;f("twitter-title",o);let c;a.description?c=a.description:document.querySelector('[data-string="intro"]')?c=document.querySelector('[data-string="intro"]').textContent.trim():c=e.description[t]||e.description.en,f("twitter-description",c);let i=a.seo&&a.seo.imageAlt||n||e.siteName;f("twitter-image-alt",i),a.seo&&a.seo.twitterCard&&f("twitter-card",a.seo.twitterCard),a.seo&&a.seo.image&&f("twitter-image",a.seo.image)}function gt(t){let e=window.pageData.siteMetadata;if(!e)return;let a=window.languageStrings[t]||{},n;a.description?n=a.description:document.querySelector('[data-string="intro"]')?n=document.querySelector('[data-string="intro"]').textContent.trim():n=e.description[t]||e.description.en,f("og-description",n);let r=new URL(window.location.href);r.searchParams.set("lang",t),f("og-url",r.toString());let o=document.querySelector('[data-string="title"]')?.textContent.trim()||"",c=a.seo&&a.seo.imageAlt||o||e.siteName;f("og-image-alt",c),a.seo&&a.seo.type&&f("og-type",a.seo.type),a.seo&&a.seo.image&&f("og-image",a.seo.image),lt(t)}function f(t,e){let a=document.querySelector(`[data-seo="${t}"]`);a&&a.setAttribute("content",e)}function lt(t){let e=document.getElementById("og-locale-alternates");if(!e)return;e.innerHTML="",(window.availableLanguages||[]).forEach(n=>{if(n!==t){let r=document.createElement("meta");r.setAttribute("property","og:locale:alternate"),r.setAttribute("content",n),r.setAttribute("data-seo",`og-locale-alternate-${n}`),e.appendChild(r)}})}function V(t,e,a){Object.keys(e).forEach(o=>{document.querySelectorAll(`[data-string="${o}"]`).forEach(i=>{i.hasAttribute("placeholder")?i.setAttribute("placeholder",e[o]):i.tagName==="INPUT"?i.value=e[o]:i.textContent=e[o]})});let n=document.querySelectorAll(`[data-post-id="${t}"].blog-card-title`);e.title&&n.forEach(o=>o.textContent=e.title);let r=document.querySelectorAll(`[data-post-id="${t}"].blog-card-excerpt`);e.excerpt&&r.forEach(o=>o.textContent=e.excerpt)}var U=k($()),S=U.ignore_pref_lang_param,A=U.lang_key;function D(t){let e=document.querySelectorAll(".nav-link"),n=new URLSearchParams(window.location.search).has(S);e.forEach(r=>{let o=r.getAttribute("href").split("?")[0];n?r.setAttribute("href",`${o}?${A}=${t}&${S}`):r.setAttribute("href",`${o}?${A}=${t}`)})}function R(){let t=document.querySelectorAll(".nav-link, .blog-card-link, a[href]:not([data-language])"),a=new URLSearchParams(window.location.search).has(S);t.forEach(n=>{n.addEventListener("click",function(r){if(n.hasAttribute("data-language"))return;let o=n.getAttribute("href");if(!o||o.startsWith("http")||o.startsWith("mailto:")||o.startsWith("#"))return;let c=new URL(o,window.location.origin),i=ut(A)||L()||"en";c.searchParams.has(A)||(c.searchParams.set(A,i),a&&c.searchParams.set(S,""),n.setAttribute("href",c.toString()))})})}function ut(t,e=null){return new URLSearchParams(window.location.search).get(t)||e}function M(t,e){let a=document.querySelector(".language-switcher");a&&a.addEventListener("click",function(n){if(n.target.tagName==="A"){n.preventDefault();let r=n.target.getAttribute("data-language");if(r&&t.includes(r)){let o=new URL(window.location.href);o.searchParams.has(S)&&(o.searchParams.delete(S),window.history.replaceState({},"",o.toString())),typeof e=="function"&&e(r)}}})}function vt(t){window.pageData=t,window.languageStrings=t.languageStrings,window.i18nGlobal=t.i18nGlobal,window.postsLanguageData=t.postsLanguageData||{},window.qaItemsData=t.qaItemsData,window.languageManifest=t.languageManifest,window.pageId=t.pageId,window.currentLanguage=t.currentLanguage,window.getUrlParam=y,window.updatePageLanguage=e=>I(e,t),window.loadLanguageData=m,document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{Q(t)}):Q(t)}function Q(t){let e=t.globalConfig.availableLanguages;R(),M(e,a=>{x(a),P(a,!0),v(a),D(a)}),dt(e)}function dt(t){window.availableLanguages=t;let e=N(),a=new URLSearchParams(window.location.search);if(v(e),e){a.has("lang")?a.get("lang")!==e?P(e):(D(e),typeof window.updatePageLanguage=="function"&&window.updatePageLanguage(e)):P(e);let r=L();e!==r&&x(e)}let n=document.querySelector(".language-switcher");n&&n.classList.add("initialized")}export{vt as initializeLanguageSystem};
